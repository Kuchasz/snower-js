<!doctype html>
<html>

<head>
    <title>Normalize your SVG paths</title>
    <link rel="stylesheet" type="text/css" href="styles.css">
</head>

<body>
    <img src="/images/snower.png" />
    <img id="loading-indicator" src="/images/loader.svg" />
    <input id="make-absolute" type="checkbox">Make absolute</input>
    <input id="convert-to-curves" type="checkbox">Convert to Curves</input>
    <div id="path-holder">
        <textarea id="path"></textarea>
    </div>
    <button id="submit-button">Normalize!</button>

    <svg width="200" height="200" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
        <path id="rendered-path" />
    </svg>

    <script>

        const submitButton = document.querySelector('#submit-button');
        const path = () => document.querySelector("#path").value;
        const makeAbsolute = () => document.querySelector("#make-absolute").checked;
        const convertToCurves = () => document.querySelector("#convert-to-curves").checked;
        const renderPath = (path) => document.querySelector('#rendered-path').setAttribute('d', path);
        const loader = {
            start: () => {
                document.querySelector("#loading-indicator").style.visibility = 'visible';
            },
            stop: () => { 
                document.querySelector("#loading-indicator").style.visibility = 'hidden'; 
            }
        };

        loader.stop();

        submitButton.addEventListener('click', () => {
            loader.start();
            fetch('/normalize', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ makeAbsolute: makeAbsolute(), convertToCurves: convertToCurves(), path: path() })
            })
                .then(res => res.json())
                .then(x => {
                    renderPath(x.path);
                    loader.stop();
                });
        });

    </script>

</body>

</html>